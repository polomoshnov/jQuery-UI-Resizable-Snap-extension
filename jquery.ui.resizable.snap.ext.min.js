/**
 * "jQuery UI Resizable Snap" - Extension to the jQuery UI Resizable plugin for snapping while resizing.
 *
 * @copyright       Copyright 2011, Alexander Polomoshnov
 * @license         MIT license (https://raw.github.com/polomoshnov/jQuery-UI-Resizable-Snap-extension/master/LICENSE.txt)
 * @link            https://github.com/polomoshnov/jQuery-UI-Resizable-Snap-extension
 * @version         1.9
 */
(function(e){function t(e,t,n){return Math.abs(e)<n?-e:Math.abs(t)<n?-t:0}function n(e){return e.sort(function(e,t){return!e?1:!t?-1:Math.abs(e)-Math.abs(t)})[0]}function r(e){return parseInt(e.css("margin-left"),10)||0}function i(e){return parseInt(e.css("margin-top"),10)||0}function s(t,n,r){var i=e.ui.resizable.prototype[t];e.ui.resizable.prototype[t]=function(){if(r)r.apply(this,arguments);i.apply(this,arguments);if(n)n.apply(this,arguments)}}e.extend(e.ui.resizable.prototype.options,{snapTolerance:20,snapMode:"both"});e.ui.plugin.add("resizable","snap",{start:function(){var t=e(this),n=t.data("ui-resizable"),s=n.options.snap;n.ow=n.helper.outerWidth()-n.size.width;n.oh=n.helper.outerHeight()-n.size.height;n.lm=r(t);n.tm=i(t);n.coords=[];e(typeof s=="string"?s:":data(ui-resizable)").each(function(){if(this==n.element[0]||this==n.helper[0])return;var t=e(this),s=t.position(),o=s.left+r(t),u=s.top+i(t);n.coords.push({l:o,t:u,r:o+t.outerWidth(),b:u+t.outerHeight()})})},resize:function(){var r=[],i=[],s=[],o=[],u=e(this).data("ui-resizable"),a=u.axis.split(""),f=u.options.snapTolerance,l=u.options.snapMode,c=u.elementOffset.left+u.lm,h=c-f,p=u.elementOffset.top+u.tm,d=p-f,v=c+u.size.width+u.ow,m=v+f,g=p+u.size.height+u.oh,y=g+f;e.each(u.coords,function(){var n=this,u=Math.min(m,n.r)-Math.max(h,n.l),b=Math.min(y,n.b)-Math.max(d,n.t);if(u<0||b<0)return;e.each(a,function(e,a){if(l=="outer"){switch(a){case"w":case"e":if(u>f*2)return;break;case"n":case"s":if(b>f*2)return}}else if(l=="inner"){switch(a){case"w":case"e":if(u<f*2)return;break;case"n":case"s":if(b<f*2)return}}switch(a){case"w":r.push(t(c-n.l,c-n.r,f));break;case"n":i.push(t(p-n.t,p-n.b,f));break;case"e":s.push(t(v-n.l,v-n.r,f));break;case"s":o.push(t(g-n.t,g-n.b,f))}})});if(o.length)u.size.height+=n(o);if(s.length)u.size.width+=n(s);if(r.length){var b=n(r);u.position.left+=b;u.size.width-=b}if(i.length){var b=n(i);u.position.top+=b;u.size.height-=b}}});s("_mouseStop",null,function(){if(this._helper){this.position={left:parseInt(this.helper.css("left"),10)||.1,top:parseInt(this.helper.css("top"),10)||.1};this.size={width:this.helper.outerWidth(),height:this.helper.outerHeight()}}});s("_mouseStart",function(){if(this._helper){this.size={width:this.size.width-(this.helper.outerWidth()-this.helper.width()),height:this.size.height-(this.helper.outerHeight()-this.helper.height())};this.originalSize={width:this.size.width,height:this.size.height}}});s("_renderProxy",function(){if(this._helper){this.helper.css({left:this.elementOffset.left,top:this.elementOffset.top,width:this.element.outerWidth(),height:this.element.outerHeight()})}});var o=e.ui.resizable.prototype.plugins.resize;e.each(o,function(e,t){if(t[0]=="ghost"){o.splice(e,1);return false}});e.each(e.ui.resizable.prototype.plugins.start,function(t,n){if(n[0]=="ghost"){var r=n[1];n[1]=function(){r.apply(this,arguments);e(this).data("ui-resizable").ghost.css({width:"100%",height:"100%"})};return false}})})(jQuery)
